{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>üõ†Ô∏è –ñ—É—Ä–Ω–∞–ª —Å–µ—Ä–≤—ñ—Å—É</h2>
    <div>
        <a href="{% url 'report_list' %}" class="btn btn-outline-secondary me-2"><i class="bi bi-clock-history"></i> –Ü—Å—Ç–æ—Ä—ñ—è –∞–∫—Ç—ñ–≤</a>

        <a href="{% url 'service_create' %}" class="btn btn-warning"><i class="bi bi-plus-lg"></i> –ù–æ–≤–∞ –∑–∞—è–≤–∫–∞</a>
    </div>
</div>

<div class="card mb-4 border-primary">
    <div class="card-body d-flex justify-content-between align-items-center bg-light">
        <div>
            <h5 class="mb-0">–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤ —Å–µ—Ä–≤—ñ—Å</h5>
            <small class="text-muted">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É, —â–æ–± –∑—ñ–±—Ä–∞—Ç–∏ –≤—Å—ñ –Ω–µ–≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –∫–∞—Ä—Ç—Ä–∏–¥–∂—ñ –≤ –æ–¥–∏–Ω –∞–∫—Ç.</small>
        </div>
        <a href="{% url 'print_preview' %}" class="btn btn-primary"><i class="bi bi-printer"></i> –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –∞–∫—Ç</a>
    </div>
</div>

<div class="card">
    <div class="table-responsive">
        <table class="table table-hover mb-0 align-middle">
            <thead class="table-dark">
                <tr>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–ü—Ä–∏—Å—Ç—Ä—ñ–π</th>
                    <th>–í—ñ–¥ –∫–æ–≥–æ</th>
                    <th>–î–∞—Ç–∏ (–û—Ç—Ä / –í—ñ–¥–ø—Ä / –ü–æ–≤)</th>
                    <th class="text-end">–î—ñ—ó</th>
                </tr>
            </thead>
            <tbody>
                {% for task in tasks %}
                <tr>
                    <td>
                        {% if task.is_completed %}
                            <span class="badge bg-success"><i class="bi bi-check-circle"></i> –ì–æ—Ç–æ–≤–æ</span>
                        {% elif task.date_sent %}
                            <span class="badge bg-secondary"><i class="bi bi-truck"></i> –í —Å–µ—Ä–≤—ñ—Å—ñ</span>
                        {% else %}
                            <span class="badge bg-danger">–ü—Ä–∏–π–Ω—è—Ç–æ</span>
                        {% endif %}
                    </td>
                    <td class="fw-bold">{{ task.device_name }}</td>
                    <td>
                        {{ task.department }}<br>
                        <small class="text-muted">{{ task.requester_name }}</small>
                    </td>
                    <td style="font-size: 0.9em;">
                        üì• {{ task.date_received|date:"d.m" }}<br>
                        üöö {{ task.date_sent|date:"d.m"|default:"-" }}<br>
                        üèÅ {{ task.date_returned|date:"d.m"|default:"-" }}
                    </td>
                    <td class="text-end">
                        {% if not task.is_completed %}
                            <a href="{% url 'service_quick_return' task.pk %}" class="btn btn-sm btn-success me-1" title="–ü–æ–≤–µ—Ä–Ω—É—Ç–∏ —Å—å–æ–≥–æ–¥–Ω—ñ">
                                <i class="bi bi-box-arrow-in-down"></i> –ü–æ–≤–µ—Ä–Ω—É—Ç–∏
                            </a>
                        {% endif %}

                        <a href="{% url 'service_update' task.pk %}" class="btn btn-sm btn-outline-primary"><i class="bi bi-pencil"></i></a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center py-4">–ñ—É—Ä–Ω–∞–ª –ø—É—Å—Ç–∏–π</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}